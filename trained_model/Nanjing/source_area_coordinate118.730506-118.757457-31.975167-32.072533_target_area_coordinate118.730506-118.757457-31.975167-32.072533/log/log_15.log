2020-11-05 19:22:40,880 - root - INFO - Namespace(K=10, O1_print_every=1, O2_print_every=1, O3_print_every=1, O4_print_every=1, auto_encoder_dim=9, batch_size=32, circle_size=500, city_name='Nanjing', data_dir='datasets/', enterprise=['大众书局', '西西弗书店'], eps=1e-09, evaluate_every=1, gamma=8, grid_size_latitude_degree=0.005, grid_size_longitude_degree=0.005, lambda_1=1, lambda_2=0.5, lambda_3=0.5, lambda_4=0.025, lr=0.001, mess_dropout=0.1, n_epoch=1000, print_every=1, save_dir='trained_model/Nanjing/source_area_coordinate118.730506-118.757457-31.975167-32.072533_target_area_coordinate118.730506-118.757457-31.975167-32.072533/', score_norm_max=400, seed=981125, source_area_coordinate=[118.730506, 118.757457, 31.975167, 32.072533], stopping_steps=10, target_area_coordinate=[118.757457, 118.80123, 31.975167, 32.072533], target_enterprise='大众书局')
2020-11-05 19:22:40,881 - root - INFO - --------------parse args and init done.
2020-11-05 19:22:43,684 - root - INFO - [1 /10]       load dianping data done.
2020-11-05 19:22:46,204 - root - INFO - [2 /10]       check enterprise and get small category set.
2020-11-05 19:22:46,205 - root - INFO - n_source_grid: 95, n_target_grid: 152
2020-11-05 19:22:46,205 - root - INFO - [3 /10]       split grid done.
2020-11-05 19:22:47,446 - root - INFO - [4 /10]       distribute data into grids done.
2020-11-05 19:22:47,452 - root - INFO - [5 /10]       generate rating matrix for Transfer Rating Prediction Model done.
2020-11-05 19:22:47,542 - root - INFO - [6 /10]       extract geographic features done.
2020-11-05 19:22:47,666 - root - INFO - [7 /10]       extract commercial features done.
2020-11-05 19:22:47,667 - root - INFO - [8 /10]       combine features done.
2020-11-05 19:22:47,727 - root - INFO - [9 /10]       get PCCS and generate delta set done.
2020-11-05 19:22:47,728 - root - INFO - [10/10]       generate training and testing index done.
2020-11-05 19:22:47,760 - root - INFO - --------------load data done.
2020-11-05 19:22:47,763 - root - INFO - CityTransfer(
  (auto_encoder): ModuleList(
    (0): AutoEncoder(
      (encoder): Sequential(
        (0): Linear(in_features=21, out_features=14, bias=True)
        (1): Tanh()
        (2): Linear(in_features=14, out_features=9, bias=True)
      )
      (decoder): Sequential(
        (0): Linear(in_features=9, out_features=14, bias=True)
        (1): Tanh()
        (2): Linear(in_features=14, out_features=21, bias=True)
      )
    )
    (1): AutoEncoder(
      (encoder): Sequential(
        (0): Linear(in_features=21, out_features=14, bias=True)
        (1): Tanh()
        (2): Linear(in_features=14, out_features=9, bias=True)
      )
      (decoder): Sequential(
        (0): Linear(in_features=9, out_features=14, bias=True)
        (1): Tanh()
        (2): Linear(in_features=14, out_features=21, bias=True)
      )
    )
  )
)
2020-11-05 19:22:47,765 - root - INFO - --------------construct model and optimizer done.
2020-11-05 19:22:47,765 - root - INFO - --------------initialize metrics done.
2020-11-05 19:22:47,765 - root - INFO - [!]-----------start training.
2020-11-05 19:22:47,775 - root - INFO - Training: Epoch 0000 / 1000 | Iter 0000 / 0004 | Time 0.0s | Iter Loss 599.9505 | Iter Mean Loss 599.9505
2020-11-05 19:22:47,783 - root - INFO - Training: Epoch 0000 / 1000 | Iter 0001 / 0004 | Time 0.0s | Iter Loss 563.8873 | Iter Mean Loss 581.9189
2020-11-05 19:22:47,790 - root - INFO - Training: Epoch 0000 / 1000 | Iter 0002 / 0004 | Time 0.0s | Iter Loss 584.5262 | Iter Mean Loss 582.7880
2020-11-05 19:22:47,798 - root - INFO - Training: Epoch 0000 / 1000 | Iter 0003 / 0004 | Time 0.0s | Iter Loss 507.9936 | Iter Mean Loss 564.0894
2020-11-05 19:22:47,806 - root - INFO - Training: Epoch 0000 / 1000 | Iter 0004 / 0004 | Time 0.0s | Iter Loss 458.8430 | Iter Mean Loss 543.0401
